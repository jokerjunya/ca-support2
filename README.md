# 📧 Gmail Assistant

AI搭載の高度なGmailアシスタント - Gmail Smart Compose・Outlook AI Assistant・Superhuman AI 相当機能を実装

## 🚀 **ワンクリック起動**

### 📱 超簡単！3ステップで開始

```bash
# 1. プロジェクトをダウンロード
git clone https://github.com/jokerjunya/ca-support5.git
cd ca-support5

# 2. ワンクリック起動（自動セットアップ付き）
./setup.sh

# または Docker で起動
./docker-start.sh
```

### 🔧 起動方法選択

| 方法 | 対象者 | 特徴 | コマンド |
|------|--------|------|----------|
| **自動セットアップ** | 初心者 | 依存関係を自動インストール | `./setup.sh` |
| **Docker起動** | 上級者 | 完全隔離環境 | `./docker-start.sh` |
| **診断のみ** | トラブル時 | 環境チェック | `./diagnose.sh` |

## 🎯 プロジェクト概要

Gmail APIと連携し、ローカルLLM (Qwen3:30B) を使用して**高度なAI返信生成**を行うメールアシスタントです。
Gmail Smart Compose、Outlook AI Assistant、Superhuman AI に相当する機能を**完全ローカル環境**で実現しています。

### ✨ **最新AI機能 (全8機能完了)**

#### 🧠 **スマートAI返信システム**
- **📝 会話要約機能** - 長いスレッドの要点を自動抽出（Outlook AI Assistant風）
- **💬 スマート返信提案** - 短い定型返信候補を自動生成（Gmail Smart Reply風）
- **🎯 文脈依存語調調整** - 相手の語調に自動適応
- **🔄 複数返信候補生成** - 語調別・長さ別の返信オプション（Superhuman AI風）
- **🧵 スレッドコンテキスト統合** - 会話全体の流れを理解した返信生成
- **🤖 強化されたLLMプロンプト** - Gmail Smart Compose方式の文脈プロンプト
- **📡 スレッド対応API** - 単一メールではなくスレッド全体を処理
- **💻 スレッドUI統合** - 2パネル表示で文脈確認しながら返信作成

#### 🖥️ **革新的なUI設計**
- **左パネル**: スレッド全体表示、AI分析セクション（会話要約・語調分析）
- **右パネル**: 返信作成エリア、AIファンクションボタン、スマート返信提案
- **リアルタイム更新**: 返信生成中のローディング、即座の候補表示
- **応答性デザイン**: 折りたたみ可能セクション、スムーズなアニメーション

### ✅ **コア機能**

- **📧 Gmail API連携**: 実際のメール取得・表示・送信
- **🔤 日本語文字化け修正**: RFC 2047エンコーディング対応
- **🧵 スレッド管理**: 完全なスレッド正規化・表示
- **🎨 テンプレートシステム**: カスタマイズ可能なメールテンプレート
- **🔍 高度な検索**: 送信者、件名、添付ファイル、日付範囲での絞り込み
- **🔐 完全ローカル処理**: データ外部送信なし、プライバシー保護
- **🌐 多言語対応**: 日本語・英語完全対応

## 📋 システム要件

### 最小要件
- **OS**: macOS 10.15+, Windows 10+, Ubuntu 18.04+
- **メモリ**: 8GB RAM （AI機能使用時: 16GB推奨）
- **ストレージ**: 15GB 空き容量（Qwen3:30B モデル含む）

### 前提ソフトウェア

**自動セットアップ使用時:**
- Node.js 18+ ([nodejs.org](https://nodejs.org/))
- Ollama ([ollama.ai](https://ollama.ai/))

**Docker使用時:**
- Docker Desktop ([docker.com](https://docker.com/))

## 🔍 起動前チェック

システム環境を事前にチェックできます：

```bash
./diagnose.sh
```

## 📖 詳細ガイド

### 📚 完全ドキュメント
- **[クイックスタートガイド](./QUICK_START_GUIDE.md)** - 詳細な起動手順
- **[トラブルシューティング](./TROUBLESHOOTING.md)** - 問題解決ガイド
- **[Gmail API設定](./GMAIL_SETUP_GUIDE.md)** - Gmail連携設定
- **[環境設定](./ENV_SETUP_TEMPLATE.md)** - 環境変数設定

### 🔧 開発者向け
- **[ペアプログラミングガイド](./PAIR_PROGRAMMING_GUIDE.md)** - 開発手順
- **[プロジェクト計画](./PROJECT_PLAN.md)** - 機能ロードマップ

## 🌐 アクセス先

起動後、以下のURLでアクセス：

- **Gmail Assistant**: http://localhost:3000
- **API サーバー**: http://localhost:3001
- **ヘルスチェック**: http://localhost:3001/health

## 💡 **高度な使い方**

### 1. 初回認証
1. http://localhost:3000 にアクセス
2. 「ログイン」ボタンでGoogle認証
3. Gmail APIアクセス許可

### 2. **スレッド統合UI**
- **左パネル**: スレッド全体の会話表示
- **AI分析セクション**: 
  - 📊 会話要約（長いスレッドの要点）
  - 🎯 語調分析（相手の語調レベル）
  - 📈 文脈情報（会話の流れ）
- **右パネル**: 返信作成エリア

### 3. **AI返信生成（8種類の機能）**
1. **💬 スマート返信提案**: ワンクリック定型返信
   - 「了解しました」「ありがとうございます」「確認します」等
2. **🧠 会話要約**: 長いスレッドの要点を自動抽出
3. **🎯 文脈依存返信**: 相手の語調に自動適応
4. **🔄 複数候補生成**: 語調別・長さ別の返信オプション
5. **📝 テンプレート適用**: カスタマイズ可能なテンプレート
6. **🤖 高度なAI返信**: Gmail Smart Compose相当の機能

### 4. **メール操作**
- 📧 実際のGmailメールを表示
- 🔵 未読メール（青色ハイライト）
- 🔴 重要メール（赤色マーク）
- 📎 添付ファイル表示・ダウンロード
- 🔍 高度な検索・フィルタ

## 🛑 停止方法

### 自動セットアップ版
```bash
# ターミナルでCtrl+C
# または
pkill -f "next dev"
pkill -f "nodemon"
```

### Docker版
```bash
# 停止
docker-compose down

# クリーンアップ付き停止
./docker-start.sh → 選択肢4
```

## 🤖 AI機能（Ollama + Qwen3:30B）

### 自動インストール
- セットアップスクリプトが自動的にチェック
- 必要に応じてインストール手順を表示

### 手動インストール
```bash
# macOS
brew install ollama

# Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Qwen3:30B モデルダウンロード（高性能日本語対応）
ollama pull qwen3:30b
```

### AI機能の詳細

| 機能 | 説明 | 相当サービス |
|------|------|-------------|
| 会話要約 | 長いスレッドの要点自動抽出 | Outlook AI Assistant |
| スマート返信 | 定型返信候補の自動生成 | Gmail Smart Reply |
| 文脈依存語調 | 相手の語調に自動適応 | - |
| 複数返信候補 | 語調別・長さ別オプション | Superhuman AI |
| スレッド統合 | 会話全体の流れを理解 | Gmail Smart Compose |
| 強化プロンプト | 文脈を考慮した返信生成 | Gmail Smart Compose |
| スレッドAPI | スレッド全体を処理 | - |
| UI統合 | 2パネル表示で文脈確認 | - |

## 📊 開発進捗

### ✅ **完了済み（全機能実装完了）**
- ✅ 基本プロジェクト構造
- ✅ Gmail API連携 + 日本語文字化け修正
- ✅ ローカルLLM統合 (Qwen3:30B)
- ✅ **8つのAI機能完全実装**
  - ✅ 会話要約機能（Outlook AI Assistant風）
  - ✅ スマート返信提案（Gmail Smart Reply風）
  - ✅ 文脈依存語調調整
  - ✅ 複数返信候補生成（Superhuman AI風）
  - ✅ スレッドコンテキスト統合
  - ✅ 強化されたLLMプロンプト
  - ✅ スレッド対応返信API
  - ✅ **スレッドUI統合（最重要機能）**
- ✅ Thread Normalizer実装
- ✅ 高度な検索・フィルタ機能
- ✅ 返信テンプレートシステム
- ✅ 自動化スクリプト作成
- ✅ Jest テスト環境構築
- ✅ **ワンクリック起動システム**
- ✅ **メール送信機能**
- ✅ **完全な本番レベル実装**

### 🔄 **今後の拡張予定**
- 🔄 クラウドデプロイ対応
- 🔄 他のメールプロバイダー対応
- 🔄 チーム機能

## 🛠 技術スタック

### フロントエンド
- **Next.js 14** - React フレームワーク
- **React** - UIライブラリ
- **TypeScript** - 型安全性
- **Tailwind CSS** - スタイリング
- **コンポーネント**: ThreadIntegratedReplyComposer, EmailDetail, etc.

### バックエンド
- **Node.js** - サーバーランタイム
- **Express.js** - Webフレームワーク
- **TypeScript** - 型安全性
- **Gmail API** - メール操作
- **8つのAIエンドポイント** - 高度な機能提供

### AI・機械学習
- **Ollama** - ローカルLLM管理
- **Qwen3:30B** - 高性能日本語モデル
- **Thread Normalizer** - スレッド正規化
- **文脈プロンプト** - Gmail Smart Compose方式

### 開発・テスト
- **Jest** - テストフレームワーク
- **Nodemon** - 開発サーバー
- **Docker** - コンテナ化
- **ESLint** - コード品質

## 🔐 セキュリティ

- 🔒 **全AI処理はローカル実行** - データ外部送信なし
- 🚫 **プライバシー保護** - メール内容は外部に送信されません
- 📧 **Gmail API** - 読み取り・送信権限のみ
- 🔑 **認証情報** - 環境変数で安全に管理
- 🛡️ **RFC 2047対応** - 日本語エンコーディング適切処理

## 🎯 **この実装の特徴**

### 🚀 **パフォーマンス**
- ローカル実行による高速処理
- スレッド正規化による効率的なデータ処理
- リアルタイムUI更新

### 🎨 **ユーザー体験**
- 直感的な2パネル設計
- スムーズなアニメーション
- 応答性の高いUI

### 🔧 **拡張性**
- モジュール化されたコンポーネント
- 型安全なTypeScript実装
- 包括的なテストカバレッジ

## 📞 サポート

### 🆘 困った時は

1. **診断ツール実行**: `./diagnose.sh`
2. **トラブルシューティング**: [TROUBLESHOOTING.md](./TROUBLESHOOTING.md)
3. **GitHub Issues**: 技術的な問題報告

### 📧 お問い合わせ

技術的な問題やバグレポートは、GitHubのIssuesページでお知らせください。

---

**🎉 完成度**: このプロジェクトは**Gmail Smart Compose**・**Outlook AI Assistant**・**Superhuman AI**相当の機能を完全実装した、**本番レベル**のAIメールアシスタントです。

**開発者向けメモ**: 今後は必ず`./setup.sh`または`./docker-start.sh`を使用して起動してください。手動でコマンドを実行する場合は、適切なディレクトリにいることを確認してください。

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。 