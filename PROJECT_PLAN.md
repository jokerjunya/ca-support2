# 📦 Gmail Assistant - ローカルLLM搭載アプリ開発計画書

## 🎯 プロジェクト概要

### 目的
日常のメール処理を「メールアプリ不要で、自動かつ安全に、高速で完結できる」体験に変える。

### ターゲットユーザー
- 毎日メールを大量に処理するビジネスパーソン
- ChatGPTなどに慣れており、返信の自動化に強い関心を持つ
- セキュリティやプライバシーに敏感なプロフェッショナル層

## 🏗️ システムアーキテクチャ

```
┌─────────────────────────────────────────────────────────────┐
│                    フロントエンド                           │
│           React + TypeScript + Tailwind CSS               │
│                  (Spotify風UI)                           │
├─────────────────────────────────────────────────────────────┤
│                    バックエンド                           │
│              Node.js + Express + TypeScript               │
│                                                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐ │
│  │   Gmail API     │  │  ローカルLLM    │  │  ローカルDB  │ │
│  │   ラッパー      │  │  (Qwen2.5-7B)  │  │  (SQLite)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 技術スタック

| カテゴリ | 技術 | 理由 |
|---------|------|------|
| **フロントエンド** | React + TypeScript + Tailwind CSS | 軽量で高速、保守性が高い |
| **バックエンド** | Node.js + Express + TypeScript | JavaScript統一、型安全性 |
| **ローカルLLM** | Qwen2.5-7B-Instruct + Ollama | 軽量で高性能、簡単セットアップ |
| **データベース** | SQLite | ローカル保存、軽量 |
| **API** | Gmail API | 公式サポート、安全性 |

## 🚀 開発フェーズ

### フェーズ1: 基盤構築（1-2週間）
1. **プロジェクトセットアップ**
   - Node.js + TypeScript + React環境構築
   - Gmail API認証設定
   - 基本UI構築

2. **基本機能実装**
   - Gmail API連携
   - メール一覧表示
   - メール詳細表示

### フェーズ2: LLM統合（1-2週間）
1. **ローカルLLM環境構築**
   - Qwen2.5-7B-Instructのセットアップ
   - Ollama または llama.cpp 使用
   - 返信生成機能実装

2. **UI改善**
   - Spotify風デザイン適用
   - 返信エディタ機能
   - 送信機能

### フェーズ3: 高度な機能（1-2週間）
1. **スレッド管理**
   - 返信履歴管理
   - 送信追跡
   - 統計ダッシュボード

2. **パフォーマンス最適化**
   - キャッシュ機能
   - バックグラウンド処理
   - エラーハンドリング

## 📝 UI設計仕様

### レイアウト（Spotify風）
```
┌─────────────────────────────────────────────────────────────┐
│  🎵 Gmail Assistant                    🔧 Settings  👤 User │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📧 Inbox (12)        │  📨 Selected Email                  │
│  ├─ 未読メール (5)     │  ┌─────────────────────────────────┐ │
│  ├─ 返信済み (7)      │  │ From: yamada@example.com       │ │
│  └─ アーカイブ        │  │ Subject: プロジェクト進捗      │ │
│                      │  │ Date: 2024-01-15               │ │
│  📝 返信案生成        │  └─────────────────────────────────┘ │
│  ├─ ビジネス調        │                                    │ │
│  ├─ カジュアル        │  📄 Email Content                 │ │
│  └─ 丁寧語           │  こんにちは、プロジェクトの...     │ │
│                      │                                    │ │
│  📊 統計              │  🤖 Generated Reply               │ │
│  ├─ 今日の処理: 15件  │  ┌─────────────────────────────────┐ │
│  └─ 平均返信時間: 2分 │  │ いつもお世話になっております。│ │
│                      │  │ プロジェクトの件について...   │ │
│                      │  └─────────────────────────────────┘ │
│                      │  [編集] [送信] [新しい案を生成]   │ │
└─────────────────────────────────────────────────────────────┘
```

## 🎯 UXフロー

1. **アプリ起動**: Webブラウザでローカルホストを開く
2. **未読メール自動取得**: 左サイドバーに未読メール一覧表示
3. **メール内容閲覧**: 右カラムに選択したメールの本文表示
4. **返信案の自動生成**: LLMがローカルで返信文を作成
5. **返信文の確認と編集**: 生成された返信文を自由に修正可能
6. **返信の送信**: Gmail APIを通じて自動送信
7. **履歴・トラッキング**: 送信履歴と統計の参照

## 📊 データ構造

### Email Interface
```typescript
interface Email {
  id: string
  threadId: string
  subject: string
  from: string
  to: string
  body: string
  date: Date
  isRead: boolean
  labels: string[]
}
```

### LLM Response Interface
```typescript
interface LLMResponse {
  generatedReply: string
  tone: ReplyTone
  confidence: number
  timestamp: Date
}

type ReplyTone = 'business' | 'casual' | 'polite' | 'brief'
```

## 🔒 セキュリティ要件

- Gmail API認証は OAuth2.0 を使用
- ローカルLLMでデータが外部に送信されない
- 送信履歴はローカルSQLiteに暗号化保存
- HTTPS必須（本番環境）

## 📈 成功指標

- メール処理時間の短縮（従来比50%削減目標）
- 返信の品質維持（人間による修正率30%以下）
- ユーザビリティスコア向上（SUS 80点以上）

## 🚨 リスク管理

- Gmail API制限への対応
- LLMの応答品質のばらつき
- 大量メール処理時のパフォーマンス
- 認証トークンの管理

## 📋 今後の拡張可能性

- 複数メールアカウント対応
- スマートラベル機能
- 返信テンプレート機能
- 音声入力対応
- モバイルアプリ化 